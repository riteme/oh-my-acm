FWT的理解

第一种：类似FFT，先对两个向量做变换，然后乘起来，然后变换回去。

第二种：分治乘法。首先考虑最高位，然后考虑$(A_0,A_1)(B_0,B_1)=(A_0B_0+A_1B_1,A_1B_0+A_0B_1)$，其中$(A,B)$表示把两个向量连起来，$A_0$是前一个向量的前一半。

注意凑一下形式，先算出来$f=(A_0+A_1)(B_0+B_1),g=(A_0-A_1)(B_0-B_1)$，就得到$(A_0,A_1)(B_0,B_1)=((f+g)/2,(f-g)/2)$

这样就只需要每次一个分成两个长度减半的，复杂度是$n\log n$的。

弱一点的可以$(A_0,A_1)(B_0,B_1)=(A_0B_0+A_1B_1,(A_0+A_1)(B_0+B_1)-(A_0B_0+A_1B_1))$就可以是一变三，复杂度$3^k$。

前者就是FFT方式理解的等价形式，因为三个变换都是一样的，所以就可以先各自做变换，然后变换回来。

但是一般情况，分治乘法也都可以做。比如$b$进制下长度是$k$的时候，暴力做是$(b^2)^k$，但是可以像上面那样凑一下，凑出一变$x$就是$x^k$，注意$x$特别小的时候主定理给的是$n\log n$之类的。总之对于任意位运算，凑出来就可以做。

比如三进制的，位运算是mex，那么就可以凑出来$(a_0,a_1,a_2)(b_0,b_1,b_2)=(a_1b_1+a_1b_2+a_2b_1+a_2b_2,a_0b_0+a_2b_0+a_0b_2,a_0b_1+a_1b_0)$，就可以变成

$$(a_0,a_1,a_2)(b_0,b_1,b_2)=((a_1+a_2)(b_1+b_2),\\(a_0+a_1+a_2)(b_0+b_1+b_2)-(a_1+a_2)(b_1+b_2))-(a_0b_1+a_1b_0),\\a_0b_1+a_1b_0)$$。

这样就是$O(4^k)$。