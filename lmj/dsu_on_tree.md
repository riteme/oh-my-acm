- 遍历每一个节点
  - 递归解决所有的轻儿子，同时消除递归产生的影响
- 递归重儿子，不消除递归的影响
- 统计所有轻儿子对答案的影响
- 更新该节点的答案
- 删除所有轻儿子对答案的影响

用来离线算出所有子树的某个答案。正常来说是启发式合并，但是启发式合并需要同时维护$n$个set，这里通过优秀的枚举顺序，只需要同时维护一个set，那么就直接用数组就可以了。这样就降低了一个log。复杂度$O(n\log n)$。

用轻重链剖分保证轻儿子只枚举$\log n$次。