求一定/可能出现在匹配中的边/点

3.2一些拓展

任意图中,设M,M'为两个不同的最大匹配,令D为M,M'的对称差

则D由若干交替环、交替链组成,且由于M,M′都是最大匹配,环、链长度都为偶数(长为奇数的交替链代表有增广路)。

这说明,任意两个最大匹配,一个都可以通过异或上若干不相交的偶链、偶环得到另一个。

特别地,两个完备匹配的对称差只有若干不相交的交替环。因为某个匹配异或长度为偶数的交替链后,链的某端点将成为未盖点,说明不是完备匹配。

3.2.1二分图最大匹配关键点

关键点是指的一定在最大匹配中的点

由于二分图左右两侧是对称的,我们只考虑找左侧的关键点。

先求任意一个最大匹配M,要找的关键点此时一定都是匹配点。考虑M中的一个匹配点p,设M'为某个不包含p的最大匹配,对称差D=M⊕M',则D中一定存在一条以p为端点的偶交替链,这条链另一端不在M中。

那么一个匹配点s能变成非匹配点,当且仅当从这个点出发能找一条以匹配边出发的交替链,使得终点是某个未盖点t。由于链长为偶数,t和s属于同一侧(左侧)。

我们倒过来考虑,先给二分图定向:匹配边从右到左、非匹配边从左到右,从左侧每个未盖点出发DFS,给到达那些点打上标记。最终左侧每个没有标记的匹配点即为关键点。因为只关心可达性,显然每个点只需访问至多一次,复杂度O(n+m)

3.2.2二分图最大匹配关键边

我们需要找到哪些边一定在最大匹配中
同样地,先求任意一个最大匹配M。
关键边一定是匹配M中的边,对于一条边e(e∈M),假设存在另一个不包含e的最大匹配M'。
M,M'的对称差中,e一定存在,则要么属于一个偶交替链、要么属于一个偶交替环。

对于偶交替链的情况,链的某一端一定是未盖点,说明e的某个端点能通过交替路走到未盖点,即某个端点是非关键点。因此只需判定e两端是否存在非关键点。
对于偶交替环的情况,我们给二分图定向:匹配边从左到右、非匹配边从右到左,再检测e是否在某个环中(因为不存在奇环)。用 Tarjan算法求强连通分量即可。
考虑复杂度,需要先On+m)求关键点,再O(n+m)用 Tarjan算法求强连通分量。

2015集训队论文陈胤伯

可能出现的点：如果一个点u（在左边）不在匹配里但是指向一个以匹配的点v，可以选择这条边，然后原来的v的匹配边删除即可。



代码：二分图点编号为左边1,3,5,..,右边2,4,6,...，输入为左边第u个点到右边第v个点连边，key数组存每个点是不是一定在最大匹配里。1表示是关键点