A\* 算法 $K$ 短路：用终点到每个点的最短距离 $h(u)$ 作为估价函数做 Dijkstra 算法。可以计算出起点到其余每个点的前 $K$ 短路。时间复杂度 $\mathrm O(mk \log m)$。

可并堆 $K$ 短路：同样用反向图的终点最短路作为每个点的势能，考虑最短路树上的非树边。这样计算的话就相当于不走非树边时默认走树上的最短路。对每一条非树边 $uv$，其权值增量为 $w(u,\ v) - h(u) + h(v)$。由于在最短路树上一直是往树根走的，因此可以对树上每个点用一个堆记录自己和自己的所有祖先相关的所有非树边，因此需要可持久化。每次扩展路径时，可以新增一条边（沿着非树边走到下一个点），或者是换掉当前的最后一条边（把最后一条边换成堆上的两个儿子）。每次扩展最多新增三条路径，因此复杂度为 $\mathrm O((m + k) \log m)$。
