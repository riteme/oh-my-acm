使用可并堆优化的 Chu-Liu 算法，这里使用左偏树。`in` 存储原图的入边。`contract` 会生成一棵 contraction 树，树根为 `n`。Contraction 树上每个节点的所有儿子构成一个环，环上每个点的入边存放在 `ed` 内。使用 `expand(r, n)` 从节点 `r` 处展开以 `r` 为根的最小树形图，如果返回 `INF` 则表示不存在树形图。`contract` 过程会增加节点并且改动边权，故使用 `w0` 保存原始边权。注意点数 $n$ 应该开到两倍。重复使用时注意收缩完后 `fa[n]` 和 `nxt[n]` 应置 $0$。`contract` 时间复杂度为 $\mathrm O(m \log n)$，`expand` 时间复杂度为 $Θ(n)$，实测随机数据下只有边数 $m$ 达到 $5×10^5$ 级别时才比朴素算法快。